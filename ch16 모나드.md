# 모나드
### chapter16. 모나드

함수형프로그래밍에서의 모나드는 순서가 있는 연산을 처리할 때, 자주 활용하는 디자인 패턴이다. 모나드를 갖춰야 하는 조건은 다음과 같다.

- 타입을 인자로 받는 타입(특정 타입의 값을 포장)
- 특정 타입의 값을 포장한 것을 반환하는 함수(메서드)가 존재
- 포장된 값을 변환하여 같은 형태로 포장하는 함수(메서드) 존재.

옵셔널은 스위프트에서 가장 기본적이며, 유용한 모나드이다.

### chapter16.1 컨텍스트
컨텍스트의 사전적 정의를 보면 '맥락', '전후 사정' 등입니다. '콘텐츠를 담은 그 무엇인가' 를 뜻한다. 즉 물컵에 물이 담겨 있으면 물은 콘텐츠고 물컵은 컨텍스트다.


함수객체란 ? : 맵을 적용할 수 있는 컨테이너 타입

### chapter16.3 모나드

함수객체 중에서 자신의 컨텍스트와 같은 컨텍스트의 형태로 맵핑할 수 있는 함수객체를 닫힌 함수객체라고 한다. 모나드는 닫힌 함수 객체입니다.

map(_: ) 은 각 요소를 2배로 만들어 모든 요소를 포하한 배열을 반환하고, flatMap(_:) 은 짝수의 경우에만 2배로 만들어 그 결과만을 포함하는 배열을 반환한다. / flatMap()은 맵과 다르게 컨텍스트 내부의 컨텍스트를 모두 같은 위상으로 평평하게 펼쳐준다는 차이가 있다. 즉 포장된 값 내부의 포장된 값의 포장을 풀어서 같은 위상으로 펼쳐준다.

Optional 타입에 사용했던 flatMap() 메서드를 Sequence 타입이 Optional 타입의 Element 를 포장한 경우에 compactMap() 이라는 이름으로 사용한다. compactMap()의 사용법은 flatMap()과 같다. 하지만 좀더 분명한 뜻을 나타내기 위해 compactMap() 을 사용한다.

map() 메소드를 사용한 결과는 Array 컨테이너 내부의 값 타입이나 형태가 어찌 되었든, Array 내부에 값이 있으면 그 값을 그저 클로저의 코드에서만 실행하고 결과를 다시 Array 컨테이너에 담기만 한다. 그러나 flatMap() 을 통해 클로저를 실행하면 알아서 내부 컨테이너까지 값을 추출한다.

스위프트에서 옵셔널에 관련된 여러 컨테이너의 값을 연달아 처리할 때, 바인딩을 통해 체인 형식으로 사용할 수 있기에, 맵보다는 플랫맵이 더욱 유용하게 쓰일 수 있다. 

func map<U>(_ transform: (Wrapped) throws -> U) rethrows -> U? : 옵셔널의 옵셔널형태로 반환, 최종반환 ex) Int??

func flatMap<U>(_ transform: (Wrapped) throws -> U?) rethrows -> U? : ex) Int? 

플랫맵은 체이닝 중간에, 연산에 실패하는 경우나 값이 없어지는 경우에는 별도의 예외 처리없이 빈 컨테이너를 반환.
